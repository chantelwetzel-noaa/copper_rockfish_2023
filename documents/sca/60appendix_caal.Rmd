# Appendices 

## Detailed Fits to Composition Data {#detailed-fit-comps}

### Length Composition Data {#length-data}

```{r, results='asis'}
plot_info = read.csv(file.path(model_dir, "plots", "plotinfotable_for_doc.csv"))
len_fit = plot_info[which(plot_info$category == "LenComp"), ]
plot.vec = grep("comp_lenfit_flt", len_fit$label)
filein = file.path(model_dir, "plots")
for (a in plot.vec){
	cap = len_fit$caption[a]
	lab = len_fit$label[a]
	add_figure(filein = file.path(filein, len_fit$file[a]), 
			   caption = cap, 
			   label = lab)
}
```

\newpage

### Age Composition Data {#age-data}


```{r, results='asis'}
plot_info = read.csv(file.path(model_dir, "plots", "plotinfotable_for_doc.csv"))
len_fit = plot_info[which(plot_info$category == "AgeComp"), ]
plot.vec = grep("comp_agefit_flt", len_fit$label)
filein = file.path(model_dir, "plots")
for (a in plot.vec){
	cap = len_fit$caption[a]
	lab = len_fit$label[a]
	add_figure(filein = file.path(filein, len_fit$file[a]), 
			   caption = cap, 
			   label = lab)
}
```

\newpage



### Conditional-Age-at-Length Composition Data {#caal-data}


```{r, results='asis'}
plot_info = read.csv(file.path(model_dir, "plots", "plotinfotable_for_doc.csv"))
len_fit = plot_info[which(plot_info$category == "A@LComp"), ]
plot.vec = c(grep("comp_condAALfit_residsflt5mkt0", len_fit$label),
  grep("comp_condAALfit_residsflt7mkt0", len_fit$label),
	grep("comp_condAALfit_residsflt9mkt0", len_fit$label))[-8]
find = sort(len_fit$label[plot.vec], index.return = TRUE)$ix
plot.vec = plot.vec[find[2:length(find)]]
filein = file.path(model_dir, "plots")
for (a in plot.vec){
	cap = len_fit$caption[a]
	lab = len_fit$label[a]
	add_figure(filein = file.path(filein, len_fit$file[a]), 
			   caption = cap, 
			   label = lab)
}
```


```{r, results='asis'}
plot_info = read.csv(file.path(model_dir, "plots", "plotinfotable_for_doc.csv"))
len_fit = plot_info[which(plot_info$category == "A@LComp"), ]
plot.vec = c(grep("comp_condAALfit_Andre_plotsflt5mkt0", len_fit$label),
  grep("comp_condAALfit_Andre_plotsflt7mkt0", len_fit$label),
	grep("comp_condAALfit_Andre_plotsflt9mkt0", len_fit$label))
find = sort(len_fit$label[plot.vec], index.return = TRUE)$ix
plot.vec = plot.vec[find[2:length(find)]]
filein = file.path(model_dir, "plots")
for (a in plot.vec){
	cap = len_fit$caption[a]
	lab = len_fit$label[a]
	add_figure(filein = file.path(filein, len_fit$file[a]), 
			   caption = cap, 
			   label = lab)
}

```

\pagebreak

## Implied Fits to Exluded Data {#excluded-data}

### Length Data 

The implied fits to the data not included in the base model due to low annual sample size are shown below.  

```{r, results='asis'}
plot_info = read.csv(file.path(model_dir, "plots", "plotinfotable_for_doc.csv"))
len_fit = plot_info[which(plot_info$category == "LenComp"), ]
plot.vec = c(grep("comp_gstlenfit_flt1mkt0", len_fit$label),
             grep("comp_gstlenfit_flt2mkt0", len_fit$label),
             grep("comp_gstlenfit_flt3mkt0", len_fit$label),
             grep("comp_gstlenfit_flt4mkt0", len_fit$label))
filein = file.path(model_dir, "plots")
for (a in plot.vec){
	cap = len_fit$caption[a]
	lab = len_fit$label[a]
	add_figure(filein = file.path(filein, len_fit$file[a]), 
			   caption = cap, 
			   label = lab)
}
``` 

\pagebreak


### MRFSS CPFV Fishery-Dependent Indices of Abundance

```{r, results = 'asis'}
add_figure(
filein = file.path(model_dir, "plots", "index5_logcpuefit_Rec_CPFV.png"), 
caption = "Implied fit to log index data on log scale for the recreational (MRFSS) CPFV index of abundance. Lines indicate 95% uncertainty interval around index values based on the model assumption of lognormal error. Thicker lines (if present) indicate input uncertainty before addition of estimated additional uncertainty parameter.",
label = 'mrfss-cpfv-index-fit')
```

\pagebreak

### CDFW ROV Survey

Data from the CDFW ROV survey were not included in the base model. A sensitivity to the inclusion of these data were included in the Sensitivities Section \ref{sensitivities}. The estimated index of abundance from the uncorrected data (see Section \ref{cdfw-rov-not-included} for additional information) is shown below with a plot of the length composition data by year `r area`. 


```{r, results = 'asis'}
sa4ss::add_figure(
filein = file.path(model_dir, "plots", "index2_cpuefit_CDFW_ROV.png"), 
caption = "The estimated weighted relative index of abundance for the CDFW ROV survy and the implied fit to the index from the model.",
label = 'rov-index')
```

\newpage


```{r, results = 'asis'}
add_figure(
filein = file.path(model_dir,  "plots", "comp_gstlenfit_flt6mkt0.png"), 
caption = "Annual length composition data from the CDFW ROV survey south of Point Conception and the implied model fit given a fixed selectivity curve.",
label = 'rov-len-data')
```

\pagebreak

### NWFSC WCGBT Survey Index of Abundance

Data from the NWFSC WCGBT survey were not used in the base model to develop an index of abundance. A sensitivity to the base model explored including the estimated index of abundance shown below 

```{r, results = 'asis'}
add_figure(
filein = file.path(data_dir, "survey_indices", "wcgbt", "110m_2005minyear", "copper_rockfish", "wcgbts",  "delta_lognormal_mix", "index", "index.png"), 
caption = "Estimated index of abundance based on NWFSC WCGBT survey data starting in 2005 and limiting to observations between 55-110 m where CA is the area south of Point Conception and coastwide is all data within California.",
label = 'wcgbt-index')
```

\pagebreak
