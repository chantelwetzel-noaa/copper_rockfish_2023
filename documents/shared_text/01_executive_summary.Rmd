
## Stock{-}

This assessment reports the status of `r spp` (*Sebastes caurinus*) off the California coast in U.S. waters, using data through 2022. The `r spp` stock was assessed using two sub-area models that captured distinct inter-stock dynamics split north and south of Point Conception. The estimated dynamics for each assessed sub-area is described here along with the combined stock status for the California stock. This assessment does not account for populations located in Mexico waters or other areas off the U.S. coast and assumes that these southern and northern populations do not contribute to the population being assessed here. 


## Catches{-}

Replace text with
trends and current levels.
Include Table for last 10 years.
Include Figure with long-term estimates.


\input{tex_tables/south_a_Catches_ES.tex}

\input{tex_tables/north_a_Catches_ES.tex}


```{r, results = 'asis'}
add_figure(
filein = file.path(south_model_dir, "plots", "catch2 landings stacked.png"), 
caption = "Landings by fleet used in the base model for the area south of Point Conception where catches in metric tons by fleet are stacked",
label = 'es-south-catch')
```



```{r, results = 'asis'}
add_figure(
filein = file.path(north_model_dir, "plots", "catch2 landings stacked.png"), 
caption = "Landings by fleet used in the base model for the area north of Point Conception where catches in metric tons by fleet are stacked",
label = 'es-north-catch')
```


## Data and assessment{-}

This assessment uses the stock assessment framework
Stock Synthesis version 3.30.21 (SS3).

Replace text with
date of last assessment,
type of assessment model,
data available,
new information, and
information lacking.

## Stock biomass and dynamics{-}

Replace text with
trends and current levels relative to virgin or historic levels and
description of uncertainty.
Include Table for last 10 years.
Include Figure with long-term estimates.

\input{tex_tables/south_b_SSB_ES.tex}

\input{tex_tables/north_b_SSB_ES.tex}

```{r, results = 'asis'}
create_biomass_table(
    doc_dir = doc_dir, 
    prefix = NULL,
    doc_names = c("nca", 'sca'),
    years = 2013:2023)

```


```{r, results = 'asis'}
add_figure(
filein = file.path(doc_dir, "shared_figures", "compare2_spawnbio_uncertainty.png"), 
caption = "Estimated time series of spawning output (circles and line: median; light broken lines: 95 percent intervals) for the model areas south and north of Point Conception",
label = 'es-sb')
```


```{r, results = 'asis'}
add_figure(
filein = file.path(doc_dir, "shared_figures", "compare4_Bratio_uncertainty.png"), 
caption = "Estimated time series of fraction of relative spawning output (circles and line: median; light broken lines: 95 percent intervals) for the model areas south and north of Point Conception",
label = 'es-depl')
```


```{r, results = 'asis'}

add_figure(
filein = file.path(doc_dir, "shared_figures", "spawning_output_combined.png"), 
caption = "Estimated combined time series of spawning output for copper rockfish in California waters",
label = 'es-sb-all')

add_figure(
filein = file.path(doc_dir, "shared_figures", "depletion_combined.png"), 
caption = "Estimated combined time series of fraction of relative spawning output for copper rockfish in California waters",
label = 'es-depl-all')

```
\clearpage

## Recruitment{-}

Replace text with
trends and current levels relative to virgin or historic levels and
description of uncertainty.
Include Table for last 10 years.
Include Figure with long-term estimates.

\input{tex_tables/south_c_Recr_ES.tex}

\input{tex_tables/north_c_Recr_ES.tex}

```{r, results = 'asis'}
add_figure(
filein = file.path(doc_dir, "shared_figures", "compare10_recruits_uncertainty.png"), 
caption = "Estimated time series of age-0 recruits (1000s) for the model areas south and north of Point Conception with 95 percent intervals",
label = 'es-recruits')
```


```{r, results = 'asis'}
add_figure(
filein = file.path(doc_dir, "shared_figures", "compare12_recdevs_uncertainty.png"), 
caption = "Estimated time series of recruitment deviations for the model areas south and north of Point Conception.",
label = 'es-rec-devs')
```

\clearpage

## Exploitation status{-}

Replace text with
total catch divided by exploitable biomass or SPR harvest rate.
Include Table for last 10 years.
Include Figure with trend in f relative to target vs. trend in biomass relative to the target.

\input{tex_tables/south_d_SPR_ES.tex}

\input{tex_tables/north_d_SPR_ES.tex}

```{r, results = 'asis'}
add_figure(
filein = file.path(doc_dir, "shared_figures", "compare6_SPRratio_uncertainty.png"), 
caption = "Estimated 1 - relative spawning ratio (SPR) by year for the model areas south and north of Point Conception. The management target is plotted as a red horizontal line and values above this reflect harvest in excess of the proxy harvest rate",
label = 'es-1-spr')
```

## Ecosystem considerations{-}

```{r, echo=FALSE, results='asis'}
filein = file.path(doc_dir, "shared_text",'es_ecosystem_considerations.Rmd')
read_child(filein)
```

## Reference points{-}


```{r, echo=FALSE, results='asis'}
filein = file.path(doc_dir, "shared_text",'es_reference_points.Rmd')
read_child(filein)
```


\input{tex_tables/south_e_ReferencePoints_ES.tex}

\input{tex_tables/north_e_ReferencePoints_ES.tex}


```{r, results = 'asis'}

ref_south <- read.csv(file.path(south_model_dir, "tables", "e_ReferencePoints_ES.csv"))
ref_north <- read.csv(file.path(north_model_dir, "tables", "e_ReferencePoints_ES.csv"))

out <- c(
  round(ref_south[1, "Estimate"] + ref_north[1, "Estimate"], 2),
  round(ref_south[2, "Estimate"] + ref_north[2, "Estimate"], 2),
  round(ref_south[3, "Estimate"] + ref_north[3, "Estimate"], 2),
  round(ref_south[4, "Estimate"] + ref_north[4, "Estimate"], 2),
  round((ref_south[4, "Estimate"] + ref_north[4, "Estimate"]) /(ref_south[1, "Estimate"] + ref_north[1, "Estimate"]), 3),
  round(ref_south[7, "Estimate"] + ref_north[7, "Estimate"], 2),
  round(ref_south[10, "Estimate"] + ref_north[10, "Estimate"], 2),
  round(ref_south[12, "Estimate"] + ref_north[12, "Estimate"], 2),
  round(ref_south[15, "Estimate"] + ref_north[15, "Estimate"], 2),
  round(ref_south[17, "Estimate"] + ref_north[17, "Estimate"], 2),
  round(ref_south[20, "Estimate"] + ref_north[20, "Estimate"], 2)
)
row_names <- c("Unfished Spawning Output", "Unfished Age 3+ Biomass (mt)", "Unfished Recruitment", "Spawning Output (2023)",
               "Relative Spawning Ouput",
               "Proxy Spawning Output (SB40%)", "Yield with SPR Based on SB40% (mt)", "Proxy Spawning Output (SPR50)", 
               "Yield with SPR50 (mt)", "Spawning Output at MSY", "MSY (mt)")

out <- cbind(row_names, out)
col_names <- c("Quantity", "Estimate")

table_format(x = out,
             caption = "Summary of reference points and management quantities for copper rockfish in California waters",
             label = "ref-point-all-es",
             align = 'l',
             digits = 3,
             col_names = col_names,
             longtable = TRUE,
             custom_width = TRUE,
             col_to_adjust = c(1), 
             width = c("6cm"))  

```


```{r, results = 'asis'}
add_figure(
filein = file.path(doc_dir, "shared_figures", "compare15_phase_plot.png"), 
caption = "Phase plot of estimated 1-SPR versus fraction unfished for the model areas south and north of Point Conception.",
label = 'es-phase')
```


```{r, results = 'asis'}
add_figure(
filein = file.path(south_model_dir, "plots", "yield2_yield_curve_with_refpoints.png"), 
caption = "Equilibrium yield curve for the base case model for model south of Point Conception. Values are based on the 2022 fishery selectivities and with steepness fixed at 0.72",
label = 'south-es-yield')
```


```{r, results = 'asis'}
add_figure(
filein = file.path(north_model_dir, "plots", "yield2_yield_curve_with_refpoints.png"), 
caption = "Equilibrium yield curve for the base case model for model north of Point Conception. Values are based on the 2022 fishery selectivities and with steepness fixed at 0.72",
label = 'north-es-yield')
```


## Management performance{-}

Include Table of most recent 10 years of
catches in comparison with OFL, ABC, HG, and OY/ACL values,
overfishing levels,
actual catch and discard.
Include OFL (encountered), OFL (retained), and OFL (dead) if different due to discard and discard mortality.


```{r, results = 'asis'}

create_management_table(
  management_dir = management_dir, 
  doc_dir = doc_dir, 
  doc_names = c("nca", 'sca'),
  years = 2012:2022,
  table_names = c("copper_ca_north.csv", "copper_ca_south.csv"),
  prefix = "es")

```

## Unresolved problems and major uncertainties{-}


```{r, echo=FALSE, results='asis'}
filein = file.path(doc_dir,'shared_text','es_unresolved_problems_uncertainties.Rmd')
read_child(filein)
```


## Decision table and projections{-}


```{r, echo=FALSE, results='asis'}
filein = file.path(doc_dir,'shared_text','es_forecasts.Rmd')
read_child(filein)
```


```{r, results = 'asis'}

create_projection_table(
    management_dir = management_dir, 
    doc_dir = doc_dir, 
    model_dir = model_dir,
    fixed_removals = c(91.5, 94.7),
    doc_names = c("nca", 'sca'),
    years = 2023:2034,
    table_names = c("copper_ca_north.csv", "copper_ca_south.csv"),
    prefix = 'es')

```


## Scientific uncertainty{-}

```{r, echo=FALSE, results='asis'}
filein = file.path(doc_dir, "shared_text",'es_scientific_uncertainty.Rmd')
read_child(filein)
```

## Research and data needs{-}

```{r, echo=FALSE, results='asis'}
filein = file.path(doc_dir, "shared_text",'es_research_and_data_needs.Rmd')
read_child(filein)
```
